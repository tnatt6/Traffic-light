#include <Wire.h>
#include "rgb_lcd.h"

rgb_lcd lcd;

// Renamed variables to avoid conflict
int GREEN_LED = 2;
int YELLOW_LED = 3;
int RED_LED = 4;

int DELAY_GREEN = 5000;
int DELAY_YELLOW = 2000;
int DELAY_RED = 5000;

void setup() {
  pinMode(GREEN_LED, OUTPUT);
  pinMode(YELLOW_LED, OUTPUT);
  pinMode(RED_LED, OUTPUT);

  lcd.begin(16, 2);
}

void loop() {
  green_light();
  flashLCD("GREEN LIGHT", DELAY_GREEN, 0, 255, 0);

  yellow_light();
  flashLCD("YELLOW LIGHT", DELAY_YELLOW, 255, 255, 0);

  red_light();
  flashLCD("RED LIGHT", DELAY_RED, 255, 0, 0);
}

void green_light() {
  digitalWrite(GREEN_LED, HIGH);
  digitalWrite(YELLOW_LED, LOW);
  digitalWrite(RED_LED, LOW);
}

void yellow_light() {
  digitalWrite(GREEN_LED, LOW);
  digitalWrite(YELLOW_LED, HIGH);
  digitalWrite(RED_LED, LOW);
}

void red_light() {
  digitalWrite(GREEN_LED, LOW);
  digitalWrite(YELLOW_LED, LOW);
  digitalWrite(RED_LED, HIGH);
}

void flashLCD(const char* text, int totalTime, int r, int g, int b) {
  int flashSpeed = 500; 
  int cycles = totalTime / flashSpeed;

  for (int i = 0; i < cycles; i++) {
    lcd.setRGB(r, g, b);
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print(text);
    delay(flashSpeed / 2);

    lcd.clear();
    lcd.setRGB(0, 0, 0);
    delay(flashSpeed / 2);
  }
}
